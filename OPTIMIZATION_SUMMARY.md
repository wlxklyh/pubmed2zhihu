# ç³»ç»Ÿä¼˜åŒ–æ€»ç»“

## å·²ä¿®å¤çš„é—®é¢˜

### 1. âœ… è·¯å¾„ä¸ä¸€è‡´é—®é¢˜
**é—®é¢˜**ï¼š`report_info.json` ä¿å­˜è·¯å¾„ä¸è¯»å–è·¯å¾„ä¸ä¸€è‡´
- ç”Ÿæˆä½ç½®ï¼š`FinalOutput/report_info.json`
- è¯»å–ä½ç½®ï¼š`step6_report/report_info.json`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- `step6_generate_report.py`ï¼šåŒæ—¶ä¿å­˜åˆ°ä¸¤ä¸ªä½ç½®ï¼ˆå…¼å®¹æ€§ï¼‰
- `web/app.py`ï¼šä¼˜å…ˆä» `FinalOutput/` è¯»å–ï¼Œå›é€€åˆ° `step6_report/`

**ä»£ç ä½ç½®**ï¼š
- `src/core/steps/step6_generate_report.py` è¡Œ1218-1225
- `web/app.py` è¡Œ242-248

---

### 2. âœ… Flaskè·¯ç”±ä¸å®Œå–„
**é—®é¢˜**ï¼šæ— æ³•è®¿é—®æŠ¥å‘Šé¡µé¢å’Œè®ºæ–‡è¯¦æƒ…é¡µ

**åŸå› **ï¼š
- è·¯ç”±åªæ”¯æŒ `/report`ï¼Œä¸æ”¯æŒå­è·¯å¾„
- ç¼ºå°‘å¯¹è®ºæ–‡è¯¦æƒ…é¡µçš„è·¯ç”±æ”¯æŒ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ·»åŠ é€šé…ç¬¦è·¯ç”±ï¼š`/project/<name>/report/<path:filename>`
- é»˜è®¤æ–‡ä»¶åè®¾ä¸º `overview_report.html`
- ä½¿ç”¨ `send_from_directory` å®‰å…¨åœ°æä¾›æ–‡ä»¶

**ä»£ç ä½ç½®**ï¼š
- `web/app.py` è¡Œ118-145

---

### 3. âœ… Flaskä»£ç ç¼“å­˜é—®é¢˜
**é—®é¢˜**ï¼šä¿®æ”¹ä»£ç åFlaskä¸è‡ªåŠ¨é‡å¯ï¼ˆ`use_reloader=False`ï¼‰

**åŸå› **ï¼šä¸ºé¿å…ä¸Playwrightå†²çªç¦ç”¨äº†è‡ªåŠ¨é‡è½½

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åˆ›å»ºä¾¿æ·çš„é‡å¯è„šæœ¬ `restart_web.ps1`
- è„šæœ¬åŠŸèƒ½ï¼šåœæ­¢æ—§è¿›ç¨‹ â†’ æ¸…ç†ç¼“å­˜ â†’ å¯åŠ¨æ–°è¿›ç¨‹
- æ·»åŠ ç¯å¢ƒå˜é‡ `PYTHONDONTWRITEBYTECODE=1` é˜²æ­¢ç”Ÿæˆpyc

**ä½¿ç”¨æ–¹å¼**ï¼š
```powershell
.\restart_web.ps1
```

---

### 4. âœ… é”™è¯¯æç¤ºä¸æ˜ç¡®
**é—®é¢˜**ï¼š"æŠ¥å‘Šå°šæœªç”Ÿæˆ" ä½†å®é™…æ–‡ä»¶å·²å­˜åœ¨ï¼Œè¯¯å¯¼ç”¨æˆ·

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—è¾“å‡º
- åŒºåˆ†"æ–‡ä»¶ä¸å­˜åœ¨"å’Œ"æŠ¥å‘Šæœªç”Ÿæˆ"çš„æƒ…å†µ
- åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æä¾›å…·ä½“çš„æ–‡ä»¶è·¯å¾„
- ç»™å‡ºæ˜ç¡®çš„æ“ä½œæŒ‡å¼•

**ä»£ç ä½ç½®**ï¼š
- `web/app.py` è¡Œ132-144

---

## æ–°å¢åŠŸèƒ½

### 1. ğŸ“ è·¯å¾„çº¦å®šæ–‡æ¡£
**æ–‡ä»¶**ï¼š`config/PATH_CONVENTION.md`

**å†…å®¹**ï¼š
- å®Œæ•´çš„é¡¹ç›®ç›®å½•ç»“æ„è¯´æ˜
- å…³é”®æ–‡ä»¶çš„ä½œç”¨å’Œæ ¼å¼
- Webè·¯ç”±æ˜ å°„è¡¨
- æ³¨æ„äº‹é¡¹å’Œæœ€ä½³å®è·µ

---

### 2. ğŸ”„ å¿«é€Ÿé‡å¯è„šæœ¬
**æ–‡ä»¶**ï¼š`restart_web.ps1`

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨åœæ­¢ç°æœ‰Flaskè¿›ç¨‹
- æ¸…ç†Pythonå­—èŠ‚ç ç¼“å­˜
- é‡æ–°å¯åŠ¨æœåŠ¡å™¨
- å½©è‰²è¾“å‡ºå’Œå‹å¥½æç¤º

---

## æ”¹è¿›å»ºè®®ï¼ˆæœªå®æ–½ï¼‰

### 1. å¯ç”¨Flaskè‡ªåŠ¨é‡è½½
**å½“å‰çŠ¶æ€**ï¼š`use_reloader=False`

**å»ºè®®**ï¼š
```python
# web/app.py
if __name__ == '__main__':
    # æ·»åŠ é…ç½®é€‰é¡¹
    use_reloader = config.get_boolean('web', 'use_reloader', False)
    app.run(host=host, port=port, debug=debug, use_reloader=use_reloader)
```

**ä¼˜ç‚¹**ï¼šå¼€å‘æ›´æ–¹ä¾¿
**ç¼ºç‚¹**ï¼šå¯èƒ½ä¸Playwrightå†²çª

---

### 2. æ·»åŠ å¥åº·æ£€æŸ¥ç«¯ç‚¹
**å»ºè®®**ï¼š
```python
@app.route('/health')
def health_check():
    return jsonify({
        'status': 'ok',
        'version': '1.0.0',
        'timestamp': datetime.now().isoformat()
    })
```

**ç”¨é€”**ï¼šæ£€æµ‹æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ

---

### 3. æ”¹è¿›HTMLç”Ÿæˆç­–ç•¥
**å½“å‰**ï¼šç›¸å¯¹è·¯å¾„ï¼ˆ`overview_report.html`ï¼‰

**å»ºè®®**ï¼š
- é€‰é¡¹Aï¼šç”Ÿæˆæ—¶ä½¿ç”¨ç»å¯¹URLè·¯å¾„
- é€‰é¡¹Bï¼šåœ¨è¯¦æƒ…é¡µæ·»åŠ  `<base>` æ ‡ç­¾
- é€‰é¡¹Cï¼šä½¿ç”¨JavaScriptåŠ¨æ€å¤„ç†è·¯å¾„

**ç¤ºä¾‹ï¼ˆé€‰é¡¹Aï¼‰**ï¼š
```python
# åœ¨ _generate_papers_list_html ä¸­
detail_url = f"/project/{project_name}/report/{detail_file}"
```

---

### 4. æ·»åŠ æŠ¥å‘Šç”Ÿæˆè¿›åº¦åé¦ˆ
**å»ºè®®**ï¼š
- ä½¿ç”¨WebSocketæˆ–SSEå®æ—¶æ¨é€ç”Ÿæˆè¿›åº¦
- æ˜¾ç¤ºå½“å‰æ­£åœ¨å¤„ç†çš„è®ºæ–‡
- ä¼°ç®—å‰©ä½™æ—¶é—´

---

### 5. ä¼˜åŒ–é”™è¯¯é¡µé¢
**å»ºè®®åœ¨ `error.html` ä¸­æ·»åŠ **ï¼š
- å¸¸è§é—®é¢˜æ’æŸ¥æ­¥éª¤
- ç›¸å…³æ–‡æ¡£é“¾æ¥
- è¿”å›æŒ‰é’®ï¼ˆè¿”å›ä¸Šä¸€é¡µï¼‰

---

## ä»£ç è´¨é‡æ”¹è¿›

### 1. æ·»åŠ ç±»å‹æ³¨è§£
```python
def view_report(project_name: str, filename: Optional[str] = None) -> Response:
    """æŸ¥çœ‹HTMLæŠ¥å‘Š"""
    ...
```

### 2. ç»Ÿä¸€æ—¥å¿—æ ¼å¼
```python
logger.info(f"[REPORT] è®¿é—®æ–‡ä»¶: {filename} | å­˜åœ¨: {exists}")
```

### 3. æ·»åŠ å•å…ƒæµ‹è¯•
```python
# tests/test_report_generation.py
def test_report_paths():
    """æµ‹è¯•æŠ¥å‘Šè·¯å¾„é€»è¾‘"""
    ...
```

---

## é…ç½®æ–‡ä»¶ä¼˜åŒ–å»ºè®®

### config.ini æ–°å¢é…ç½®é¡¹

```ini
[paths]
# è·¯å¾„é…ç½®
final_output_dirname = FinalOutput
legacy_report_dirname = step6_report
overview_filename = overview_report.html

[web]
# WebæœåŠ¡é…ç½®
use_reloader = false
enable_debug_logs = true
report_cache_timeout = 300
```

---

## æ–‡æ¡£æ›´æ–°

### README.md éœ€è¦æ›´æ–°çš„éƒ¨åˆ†

1. **å¿«é€Ÿå¯åŠ¨**ï¼šæ·»åŠ  `restart_web.ps1` è¯´æ˜
2. **ç›®å½•ç»“æ„**ï¼šå¼•ç”¨ `PATH_CONVENTION.md`
3. **æ•…éšœæ’é™¤**ï¼šæ·»åŠ å¸¸è§é—®é¢˜è§£ç­”

### æ–°å¢æ–‡æ¡£å»ºè®®

1. `docs/API.md`ï¼šWeb APIæ–‡æ¡£
2. `docs/DEPLOYMENT.md`ï¼šéƒ¨ç½²æŒ‡å—
3. `docs/TROUBLESHOOTING.md`ï¼šæ•…éšœæ’é™¤

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ç¼“å­˜LLMå“åº”
```python
from functools import lru_cache

@lru_cache(maxsize=10)
def load_llm_response_cached(project_path: str):
    """ç¼“å­˜LLMå“åº”ï¼Œé¿å…é‡å¤è¯»å–"""
    ...
```

### 2. å¼‚æ­¥æ–‡ä»¶è¯»å–
```python
import aiofiles

async def load_project_data_async(project_path):
    """å¼‚æ­¥åŠ è½½é¡¹ç›®æ•°æ®"""
    ...
```

### 3. å‹ç¼©HTMLè¾“å‡º
```python
from flask import Flask
from flask_compress import Compress

app = Flask(__name__)
Compress(app)  # è‡ªåŠ¨gzipå‹ç¼©
```

---

## æ€»ç»“

### æ ¸å¿ƒæ”¹è¿›
1. âœ… è·¯å¾„ç»Ÿä¸€å’Œå…¼å®¹æ€§å¤„ç†
2. âœ… Flaskè·¯ç”±å®Œå–„
3. âœ… ä¾¿æ·çš„é‡å¯å·¥å…·
4. âœ… è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
5. âœ… å®Œæ•´çš„æ–‡æ¡£è¯´æ˜

### æµ‹è¯•éªŒè¯
- âœ… ä¸»æŠ¥å‘Šé¡µé¢è®¿é—®æ­£å¸¸
- âœ… 20ç¯‡è®ºæ–‡è¯¦æƒ…é¡µç”ŸæˆæˆåŠŸ
- âœ… é¡µé¢é—´å¯¼èˆªæµç•…
- âœ… ä¸­è‹±æ–‡å†…å®¹å®Œæ•´æ˜¾ç¤º

### å¾…ä¼˜åŒ–é¡¹
- â³ å¯ç”¨è‡ªåŠ¨é‡è½½ï¼ˆå¯é€‰ï¼‰
- â³ æ·»åŠ å¥åº·æ£€æŸ¥ç«¯ç‚¹
- â³ æ”¹è¿›HTMLè·¯å¾„ç­–ç•¥
- â³ å®æ—¶è¿›åº¦åé¦ˆ
- â³ æ·»åŠ å•å…ƒæµ‹è¯•

---

**æœ€åæ›´æ–°**: 2026-01-01  
**ä¼˜åŒ–è€…**: AI Assistant (Claude Sonnet 4.5)

